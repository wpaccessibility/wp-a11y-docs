{% assign parentTitle = page.parent %}
{% assign introPage   = site.pages | where: "title", parentTitle | first %}
{% assign currentPage = page %}

{% assign siblings    = site.pages | where: "parent", parentTitle | sort: "nav_order" %}

{% for p in siblings %}
{% if p.title == currentPage.title %}
{% assign index = forloop.index0 %}
{% endif %}
{% endfor %}

{% assign thisPage = siblings[index]  %}

{% assign prevIndex = index | minus: 1 %}
{% assign prev = siblings[prevIndex]  %}

{% assign nextIndex = index | plus: 1 %}
{% assign next = siblings[nextIndex]  %}

{% if prev and currentPage.title != "Home" %}
<nav class="prev-next">
    <h2>Next and previous pages</h2>
    <ul>
        <li>
            {% if prev and currentPage.title != "Home" %}
            <a class="prev" href="{{ prev.url }}">Previous: {{ prev.title }}</a>
            {% endif %}
        </li>
        <li>
            {% if next %}
            <a class="next" href="{{ next.url }}">Next: {{ next.title }}</a>
            {% endif %}
        </li>
        <li>
            {% if introPage.title %}
            <a href="{{ introPage.url }}">Back to: {{introPage.title }}</a>
            {% endif %}
        </li>
    </ul>
</nav>
{% endif %}
